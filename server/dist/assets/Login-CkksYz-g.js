import{ag as p,a6 as g,a7 as j,a1 as b,r as h,a9 as y,j as e,ah as N,ab as w,ai as v,K as u,aj as E,ak as _,al as A,am as M,O as S,an as k}from"./index-DRAgHsIT.js";import{j as I,A as L,c as C}from"./index-CjPgBJJY.js";import{a as P,b as V,c as q}from"./chunk-MW56SEHC-C_SpdkDN.js";const z=()=>{const{login:i}=p();return g({mutationFn:t=>j.post("/api/auth/login",t),onSuccess:({data:{token:t}})=>{const{email:n,username:o}=I(t);b.success(`Welcome ${o}!`),i(t,n,o)}})},K=()=>{var l,d;const[i,t]=h.useState(!1),{register:n,handleSubmit:o,reset:m,formState:{errors:s}}=y({defaultValues:{email:"",password:""}}),a=z(),x=()=>t(r=>!r),f=async r=>{a.mutate(r,{onError:()=>m()})};return e.jsx("section",{className:"bg-gradient-1 h-[100dvh] flex items-center justify-center",children:e.jsxs(P,{className:"md:w-[30%]",children:[e.jsx(V,{className:"flex justify-center",children:e.jsx(N,{})}),e.jsx(w,{}),e.jsxs(q,{className:"w-full",children:[e.jsx("p",{className:"text-2xl tracking-tight font-bold text-gray-900 text-center",children:"Sign in to your account"}),a.isError&&e.jsx(L,{message:(()=>{var r,c;return v(a.error)?((c=(r=a.error.response)==null?void 0:r.data)==null?void 0:c.message)||a.error.message||"Network error occurred":a.error instanceof Error?a.error.message:"An unexpected error occurred during login."})(),type:"error"}),e.jsxs("form",{className:"flex flex-col gap-y-4",onSubmit:o(f),children:[e.jsx(u,{type:"email",label:"Email",radius:"sm",labelPlacement:"outside",startContent:e.jsx(E,{className:"text-2xl text-default-400 pointer-events-none flex-shrink-0"}),...n("email",{required:"Email Address is required",pattern:{value:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,message:"Email address is invalid"}}),isInvalid:!!(s!=null&&s.email),errorMessage:(l=s==null?void 0:s.email)==null?void 0:l.message}),e.jsx(u,{label:"Password",radius:"sm",labelPlacement:"outside",startContent:e.jsx(M,{className:"text-2xl text-default-400 pointer-events-none flex-shrink-0"}),endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:x,"aria-label":"toggle password visibility",children:i?e.jsx(_,{className:"text-2xl text-default-400 pointer-events-none"}):e.jsx(A,{className:"text-2xl text-default-400 pointer-events-none"})}),type:i?"text":"password",...n("password",{required:"Password is required"}),autoComplete:"off",isInvalid:!!(s!=null&&s.password),errorMessage:(d=s==null?void 0:s.password)==null?void 0:d.message}),e.jsx(S,{color:"primary",radius:"sm",className:"mt-2",type:"submit",isLoading:a==null?void 0:a.isPending,children:"Login"})]})]}),e.jsxs(C,{className:"flex gap-2 justify-center text-sm px-2 text-gray-500 pt-2 pb-4",children:[e.jsx("p",{children:"New to TinyLink?"}),e.jsx(k,{className:"underline hover:text-blue-500 transition duration-300 ease-in-out",to:"/register",children:"Create an account"})]})]})})};export{K as default};
